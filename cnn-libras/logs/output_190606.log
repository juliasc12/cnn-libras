[INFO] [INICIO]: 20190605_2343

[INFO] Download dataset usando keras.preprocessing.image.ImageDataGenerator
Found 34714 images belonging to 21 classes.
Found 11548 images belonging to 21 classes.
[INFO] Inicializando e otimizando a CNN...
[INFO] Treinando a CNN...
Epoch 1/30
 - 300s - loss: 2.9312 - acc: 0.1164 - val_loss: 2.3551 - val_acc: 0.2802
Epoch 2/30
 - 164s - loss: 1.6238 - acc: 0.4888 - val_loss: 0.8540 - val_acc: 0.7658
Epoch 3/30
 - 168s - loss: 0.8566 - acc: 0.7309 - val_loss: 0.4849 - val_acc: 0.8423
Epoch 4/30
 - 163s - loss: 0.5605 - acc: 0.8186 - val_loss: 0.3097 - val_acc: 0.9106
Epoch 5/30
 - 161s - loss: 0.4158 - acc: 0.8639 - val_loss: 0.2255 - val_acc: 0.9337
Epoch 6/30
 - 162s - loss: 0.3260 - acc: 0.8927 - val_loss: 0.1975 - val_acc: 0.9392
Epoch 7/30
 - 162s - loss: 0.2724 - acc: 0.9095 - val_loss: 0.1697 - val_acc: 0.9457
Epoch 8/30
 - 162s - loss: 0.2294 - acc: 0.9216 - val_loss: 0.1606 - val_acc: 0.9492
Epoch 9/30
 - 162s - loss: 0.2003 - acc: 0.9331 - val_loss: 0.1322 - val_acc: 0.9599
Epoch 10/30
 - 162s - loss: 0.1777 - acc: 0.9412 - val_loss: 0.1152 - val_acc: 0.9663
Epoch 11/30
 - 162s - loss: 0.1558 - acc: 0.9474 - val_loss: 0.1154 - val_acc: 0.9628
Epoch 12/30
 - 162s - loss: 0.1410 - acc: 0.9519 - val_loss: 0.0986 - val_acc: 0.9674
Epoch 13/30
 - 162s - loss: 0.1251 - acc: 0.9567 - val_loss: 0.1049 - val_acc: 0.9696
Epoch 14/30
 - 162s - loss: 0.1167 - acc: 0.9612 - val_loss: 0.1022 - val_acc: 0.9692
Epoch 15/30
 - 162s - loss: 0.1150 - acc: 0.9609 - val_loss: 0.0977 - val_acc: 0.9733
Epoch 16/30
 - 162s - loss: 0.1027 - acc: 0.9651 - val_loss: 0.0826 - val_acc: 0.9756
Epoch 17/30
 - 162s - loss: 0.0977 - acc: 0.9665 - val_loss: 0.0908 - val_acc: 0.9737
Epoch 18/30
 - 162s - loss: 0.0945 - acc: 0.9682 - val_loss: 0.0807 - val_acc: 0.9781
Epoch 19/30
 - 165s - loss: 0.0846 - acc: 0.9704 - val_loss: 0.0786 - val_acc: 0.9770
Epoch 20/30
 - 162s - loss: 0.0794 - acc: 0.9730 - val_loss: 0.0841 - val_acc: 0.9760
Epoch 21/30
 - 162s - loss: 0.0739 - acc: 0.9752 - val_loss: 0.0752 - val_acc: 0.9792
Epoch 22/30
 - 162s - loss: 0.0730 - acc: 0.9760 - val_loss: 0.0752 - val_acc: 0.9799
Epoch 23/30
 - 162s - loss: 0.0709 - acc: 0.9749 - val_loss: 0.0679 - val_acc: 0.9803
Epoch 24/30
 - 162s - loss: 0.0677 - acc: 0.9768 - val_loss: 0.0852 - val_acc: 0.9786
Epoch 25/30
 - 162s - loss: 0.0582 - acc: 0.9795 - val_loss: 0.0711 - val_acc: 0.9810
Epoch 26/30
 - 162s - loss: 0.0548 - acc: 0.9809 - val_loss: 0.0711 - val_acc: 0.9797
Epoch 27/30
 - 162s - loss: 0.0566 - acc: 0.9808 - val_loss: 0.0640 - val_acc: 0.9802
Epoch 28/30
 - 162s - loss: 0.0552 - acc: 0.9804 - val_loss: 0.0596 - val_acc: 0.9845
Epoch 29/30
 - 162s - loss: 0.0544 - acc: 0.9815 - val_loss: 0.0567 - val_acc: 0.9827
Epoch 30/30
 - 162s - loss: 0.0506 - acc: 0.9825 - val_loss: 0.0592 - val_acc: 0.9850
[INFO] Salvando modelo treinado ...
[INFO] modelo: ../models/cnn_model_LIBRAS_20190606_0106.h5 salvo!
[INFO] Tempo de execução da CNN: 83.5 min
[INFO] Summary: 
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 64, 64, 32)        896       
_________________________________________________________________
leaky_re_lu_1 (LeakyReLU)    (None, 64, 64, 32)        0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 32, 32)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 30, 30, 32)        9248      
_________________________________________________________________
leaky_re_lu_2 (LeakyReLU)    (None, 30, 30, 32)        0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 15, 15, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 13, 13, 64)        18496     
_________________________________________________________________
leaky_re_lu_3 (LeakyReLU)    (None, 13, 13, 64)        0         
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 6, 6, 64)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 2304)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               590080    
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 21)                5397      
=================================================================
Total params: 624,117
Trainable params: 624,117
Non-trainable params: 0
_________________________________________________________________

[INFO] Avaliando a CNN...

  1/360 [..............................] - ETA: 20s
  2/360 [..............................] - ETA: 20s
  4/360 [..............................] - ETA: 15s
  6/360 [..............................] - ETA: 14s
  8/360 [..............................] - ETA: 13s
 10/360 [..............................] - ETA: 13s
 12/360 [>.............................] - ETA: 13s
 14/360 [>.............................] - ETA: 13s
 16/360 [>.............................] - ETA: 13s
 18/360 [>.............................] - ETA: 13s
 20/360 [>.............................] - ETA: 13s
 22/360 [>.............................] - ETA: 13s
 24/360 [=>............................] - ETA: 13s
 26/360 [=>............................] - ETA: 13s
 28/360 [=>............................] - ETA: 13s
 30/360 [=>............................] - ETA: 13s
 32/360 [=>............................] - ETA: 13s
 34/360 [=>............................] - ETA: 13s
 36/360 [==>...........................] - ETA: 13s
 38/360 [==>...........................] - ETA: 13s
 40/360 [==>...........................] - ETA: 12s
 42/360 [==>...........................] - ETA: 12s
 44/360 [==>...........................] - ETA: 12s
 46/360 [==>...........................] - ETA: 12s
 48/360 [===>..........................] - ETA: 12s
 50/360 [===>..........................] - ETA: 12s
 52/360 [===>..........................] - ETA: 12s
 54/360 [===>..........................] - ETA: 12s
 56/360 [===>..........................] - ETA: 12s
 58/360 [===>..........................] - ETA: 12s
 60/360 [====>.........................] - ETA: 12s
 62/360 [====>.........................] - ETA: 12s
 64/360 [====>.........................] - ETA: 12s
 66/360 [====>.........................] - ETA: 11s
 68/360 [====>.........................] - ETA: 11s
 70/360 [====>.........................] - ETA: 11s
 72/360 [=====>........................] - ETA: 11s
 74/360 [=====>........................] - ETA: 11s
 76/360 [=====>........................] - ETA: 11s
 78/360 [=====>........................] - ETA: 11s
 80/360 [=====>........................] - ETA: 11s
 82/360 [=====>........................] - ETA: 11s
 84/360 [======>.......................] - ETA: 11s
 86/360 [======>.......................] - ETA: 11s
 88/360 [======>.......................] - ETA: 11s
 90/360 [======>.......................] - ETA: 10s
 92/360 [======>.......................] - ETA: 10s
 94/360 [======>.......................] - ETA: 10s
 96/360 [=======>......................] - ETA: 10s
 98/360 [=======>......................] - ETA: 10s
100/360 [=======>......................] - ETA: 10s
102/360 [=======>......................] - ETA: 10s
104/360 [=======>......................] - ETA: 10s
106/360 [=======>......................] - ETA: 10s
108/360 [========>.....................] - ETA: 10s
110/360 [========>.....................] - ETA: 10s
112/360 [========>.....................] - ETA: 10s
114/360 [========>.....................] - ETA: 10s
116/360 [========>.....................] - ETA: 9s 
118/360 [========>.....................] - ETA: 9s
120/360 [=========>....................] - ETA: 9s
122/360 [=========>....................] - ETA: 9s
124/360 [=========>....................] - ETA: 9s
126/360 [=========>....................] - ETA: 9s
128/360 [=========>....................] - ETA: 9s
130/360 [=========>....................] - ETA: 9s
132/360 [==========>...................] - ETA: 9s
134/360 [==========>...................] - ETA: 9s
136/360 [==========>...................] - ETA: 9s
138/360 [==========>...................] - ETA: 9s
140/360 [==========>...................] - ETA: 8s
142/360 [==========>...................] - ETA: 8s
144/360 [===========>..................] - ETA: 8s
146/360 [===========>..................] - ETA: 8s
148/360 [===========>..................] - ETA: 8s
150/360 [===========>..................] - ETA: 8s
152/360 [===========>..................] - ETA: 8s
154/360 [===========>..................] - ETA: 8s
156/360 [============>.................] - ETA: 8s
158/360 [============>.................] - ETA: 8s
160/360 [============>.................] - ETA: 8s
162/360 [============>.................] - ETA: 8s
164/360 [============>.................] - ETA: 7s
166/360 [============>.................] - ETA: 7s
168/360 [=============>................] - ETA: 7s
170/360 [=============>................] - ETA: 7s
172/360 [=============>................] - ETA: 7s
174/360 [=============>................] - ETA: 7s
176/360 [=============>................] - ETA: 7s
178/360 [=============>................] - ETA: 7s
180/360 [==============>...............] - ETA: 7s
182/360 [==============>...............] - ETA: 7s
184/360 [==============>...............] - ETA: 7s
186/360 [==============>...............] - ETA: 7s
188/360 [==============>...............] - ETA: 7s
190/360 [==============>...............] - ETA: 6s
192/360 [===============>..............] - ETA: 6s
194/360 [===============>..............] - ETA: 6s
196/360 [===============>..............] - ETA: 6s
198/360 [===============>..............] - ETA: 6s
200/360 [===============>..............] - ETA: 6s
202/360 [===============>..............] - ETA: 6s
204/360 [================>.............] - ETA: 6s
206/360 [================>.............] - ETA: 6s
208/360 [================>.............] - ETA: 6s
210/360 [================>.............] - ETA: 6s
212/360 [================>.............] - ETA: 6s
214/360 [================>.............] - ETA: 5s
216/360 [=================>............] - ETA: 5s
218/360 [=================>............] - ETA: 5s
220/360 [=================>............] - ETA: 5s
222/360 [=================>............] - ETA: 5s
224/360 [=================>............] - ETA: 5s
226/360 [=================>............] - ETA: 5s
228/360 [==================>...........] - ETA: 5s
230/360 [==================>...........] - ETA: 5s
232/360 [==================>...........] - ETA: 5s
234/360 [==================>...........] - ETA: 5s
236/360 [==================>...........] - ETA: 5s
238/360 [==================>...........] - ETA: 4s
240/360 [===================>..........] - ETA: 4s
242/360 [===================>..........] - ETA: 4s
244/360 [===================>..........] - ETA: 4s
246/360 [===================>..........] - ETA: 4s
248/360 [===================>..........] - ETA: 4s
250/360 [===================>..........] - ETA: 4s
252/360 [====================>.........] - ETA: 4s
254/360 [====================>.........] - ETA: 4s
256/360 [====================>.........] - ETA: 4s
258/360 [====================>.........] - ETA: 4s
260/360 [====================>.........] - ETA: 4s
262/360 [====================>.........] - ETA: 3s
264/360 [=====================>........] - ETA: 3s
266/360 [=====================>........] - ETA: 3s
268/360 [=====================>........] - ETA: 3s
270/360 [=====================>........] - ETA: 3s
272/360 [=====================>........] - ETA: 3s
274/360 [=====================>........] - ETA: 3s
276/360 [======================>.......] - ETA: 3s
278/360 [======================>.......] - ETA: 3s
280/360 [======================>.......] - ETA: 3s
282/360 [======================>.......] - ETA: 3s
284/360 [======================>.......] - ETA: 3s
286/360 [======================>.......] - ETA: 3s
288/360 [=======================>......] - ETA: 2s
290/360 [=======================>......] - ETA: 2s
292/360 [=======================>......] - ETA: 2s
294/360 [=======================>......] - ETA: 2s
296/360 [=======================>......] - ETA: 2s
298/360 [=======================>......] - ETA: 2s
300/360 [========================>.....] - ETA: 2s
302/360 [========================>.....] - ETA: 2s
304/360 [========================>.....] - ETA: 2s
306/360 [========================>.....] - ETA: 2s
308/360 [========================>.....] - ETA: 2s
310/360 [========================>.....] - ETA: 2s
312/360 [=========================>....] - ETA: 1s
314/360 [=========================>....] - ETA: 1s
316/360 [=========================>....] - ETA: 1s
318/360 [=========================>....] - ETA: 1s
320/360 [=========================>....] - ETA: 1s
322/360 [=========================>....] - ETA: 1s
324/360 [==========================>...] - ETA: 1s
326/360 [==========================>...] - ETA: 1s
328/360 [==========================>...] - ETA: 1s
330/360 [==========================>...] - ETA: 1s
332/360 [==========================>...] - ETA: 1s
334/360 [==========================>...] - ETA: 1s
336/360 [===========================>..] - ETA: 0s
338/360 [===========================>..] - ETA: 0s
340/360 [===========================>..] - ETA: 0s
342/360 [===========================>..] - ETA: 0s
344/360 [===========================>..] - ETA: 0s
346/360 [===========================>..] - ETA: 0s
348/360 [============================>.] - ETA: 0s
350/360 [============================>.] - ETA: 0s
352/360 [============================>.] - ETA: 0s
354/360 [============================>.] - ETA: 0s
356/360 [============================>.] - ETA: 0s
358/360 [============================>.] - ETA: 0s
360/360 [==============================] - 15s 41ms/step
[INFO] Accuracy: 98.63% | Loss: 0.05352
[INFO] Sumarizando loss e accuracy para os datasets 'train' e 'test'
[INFO] Gerando imagem do modelo de camadas da CNN

[INFO] [FIM]: 20190606_0106



